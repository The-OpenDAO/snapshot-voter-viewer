(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5301:function(r,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(4186)}])},4186:function(r,e,t){"use strict";t.r(e);var n,o=t(4051),i=t.n(o),c=t(5893),a=t(6908),s=t(3165),u=t(4040),l=t(9214),d=t(8220),f=t(5566),p=t(7501),h=t(804),v=t(7294),b=t(9669),g=t.n(b);function y(r,e){(null==e||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function m(r,e,t,n,o,i,c){try{var a=r[i](c),s=a.value}catch(u){return void t(u)}a.done?e(s):Promise.resolve(s).then(n,o)}function x(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function w(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})))),n.forEach((function(e){x(r,e,t[e])}))}return r}function P(r){return function(r){if(Array.isArray(r))return y(r)}(r)||function(r){if("undefined"!==typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||function(r,e){if(!r)return;if("string"===typeof r)return y(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);"Object"===t&&r.constructor&&(t=r.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return y(r,e)}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}!function(r){r[r.None=0]="None",r[r.Pulling=1]="Pulling",r[r.Pulled=2]="Pulled"}(n||(n={}));e.default=function(){var r=(0,a.Z)("https://snapshot.org/#/theopendao.eth/proposal/0xacbc420c3696740786c76065c51cb8bc5ed0982d2162ee3f74441c14785b91c6"),e=(0,v.useState)([]),t=e[0],o=e[1],b=(0,v.useState)(n.None),y=b[0],x=b[1],j=(0,v.useMemo)((function(){var e="https://snapshot.org/#/theopendao.eth/proposal/",t=r.value.trim(),n={correct:!0,id:""};if(""===t)return n;if(!t.startsWith(e))return n.correct=!1,n;var o=t.substring(e.length);return/^0x[0-9a-zA-Z]{64}$/.test(o)?(n.id=o,n):(n.correct=!1,n)}),[r.value]),k=(0,v.useCallback)(function(){var r,e=(r=i().mark((function r(e){var t,c,a,s;return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:o([]),x(n.Pulling),t=0,c=500;case 4:return r.next=7,g().post("https://hub.snapshot.org/graphql",{operationName:"Votes",query:"query Votes($id: String!, $first: Int, $skip: Int, $orderBy: String, $orderDirection: OrderDirection, $voter: String) {\n  votes(\n    first: $first\n    skip: $skip\n    where: {proposal: $id, vp_gt: 0, voter: $voter}\n    orderBy: $orderBy\n    orderDirection: $orderDirection\n  ) {\n    voter\n  }\n}",variables:{id:e,orderBy:"vp",orderDirection:"desc",first:c,skip:c*t}});case 7:if(a=r.sent,t++,0!==(s=a.data.data.votes.map((function(r){return r.voter}))).length){r.next=12;break}return r.abrupt("break",15);case 12:o((function(r){return P(r).concat(P(s))})),r.next=4;break;case 15:x(n.Pulled);case 16:case"end":return r.stop()}}),r)})),function(){var e=this,t=arguments;return new Promise((function(n,o){var i=r.apply(e,t);function c(r){m(i,n,o,c,a,"next",r)}function a(r){m(i,n,o,c,a,"throw",r)}c(void 0)}))});return function(r){return e.apply(this,arguments)}}(),[o,x]),Z=(0,v.useCallback)((function(){if(y===n.Pulled){var r=["voter"].concat(P(t)).join("\r\n"),e=new Blob([r],{type:"text/csv"}),o=document.createElement("a");o.href=window.URL.createObjectURL(e),o.download="voters-".concat(j.id,"-").concat(+new Date,".csv"),o.click()}}),[t,y,j.id]);return(0,c.jsxs)(s.Z,{fluid:!0,css:{marginTop:"5rem"},gap:1,children:[(0,c.jsx)(u.Z,{align:"center",children:(0,c.jsx)(l.Z,{h1:!0,children:"Snapshot Voter Viewer"})}),(0,c.jsx)(u.Z,{children:(0,c.jsx)(d.ZP,w({},r.bindings,{label:"URL to the proposal",placeholder:"https://snapshot.org/#/theopendao.eth/proposal/0xexample",status:j.correct?"default":"error",color:j.correct?"default":"error",helperColor:j.correct?"default":"error",helperText:j.correct?"":"Invalid proposal URL",width:"50%"}))}),(0,c.jsxs)(u.Z,{children:[(0,c.jsx)(f.ZP,{onClick:function(){return k(j.id)},clickable:!!j.id&&y!==n.Pulling,children:y===n.Pulling?(0,c.jsx)(p.ZP,{color:"white",size:"sm"}):"Load Voters"}),(0,c.jsx)(f.ZP,{onClick:function(){return Z()},children:"Export Voters"})]}),y!==n.None&&(0,c.jsx)(u.Z,{children:(0,c.jsxs)(h.ZP,{css:{height:"auto",minWidth:"100%"},children:[(0,c.jsx)(h.ZP.Header,{children:(0,c.jsxs)(h.ZP.Column,{children:["Voter (",t.length,")"]})}),(0,c.jsx)(h.ZP.Body,{children:t.map((function(r,e){return(0,c.jsx)(h.ZP.Row,{children:(0,c.jsx)(h.ZP.Cell,{children:r})},e)}))})]})})]})}}},function(r){r.O(0,[453,774,888,179],(function(){return e=5301,r(r.s=e);var e}));var e=r.O();_N_E=e}]);